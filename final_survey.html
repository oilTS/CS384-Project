<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>แบบสอบถามหลังการทดลอง</title>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="main.js"></script>
</head>

<body>

<h2>แบบสอบถามหลังเสร็จสิ้นการทดลอง</h2>
<p class="notice">คำชี้แจง: กรุณาตอบแบบสอบถามให้ครบถ้วนทุกข้อเพื่อเสร็จสิ้นกระบวนการทดลอง</p>

<form id="surveyForm">

    <div class="question-block">
        <p><b>1. ท่านมีความพึงพอใจด้าน "สุนทรียภาพ" (Aesthetics) จากการรับสารด้วยวิธีการ <u>อ่าน</u> มากน้อยเพียงใด </b></p>
        <label><input type="radio" name="q1" value="1"> 1 (น้อยที่สุด) </label><br>
        <label><input type="radio" name="q1" value="2"> 2 (น้อย) </label><br>
        <label><input type="radio" name="q1" value="3"> 3 (ปานกลาง) </label><br>
        <label><input type="radio" name="q1" value="4"> 4 (มาก) </label><br>
        <label><input type="radio" name="q1" value="5"> 5 (มากที่สุด) </label>
    </div>
    <hr>
    <div class="question-block">
        <p><b>2. ท่านมีความพึงพอใจด้าน "สุนทรียภาพ" (Aesthetics) จากการรับสารด้วยวิธีการ <u>ฟัง</u> มากน้อยเพียงใด </b></p>
        <label><input type="radio" name="q2" value="1"> 1 (น้อยที่สุด) </label><br>
        <label><input type="radio" name="q2" value="2"> 2 (น้อย) </label><br>
        <label><input type="radio" name="q2" value="3"> 3 (ปานกลาง) </label><br>
        <label><input type="radio" name="q2" value="4"> 4 (มาก) </label><br>
        <label><input type="radio" name="q2" value="5"> 5 (มากที่สุด) </label>
    </div>
    <hr>
    <div class="question-block">
        <p><b>3. ท่านคิดว่าการรับสารด้วยวิธีการ <u>อ่าน</u> ส่งผลต่อ "ความเข้าใจเนื้อหา" มากน้อยเพียงใด </b></p>
        <label><input type="radio" name="q3" value="1"> 1 (น้อยที่สุด) </label><br>
        <label><input type="radio" name="q3" value="2"> 2 (น้อย) </label><br>
        <label><input type="radio" name="q3" value="3"> 3 (ปานกลาง) </label><br>
        <label><input type="radio" name="q3" value="4"> 4 (มาก) </label><br>
        <label><input type="radio" name="q3" value="5"> 5 (มากที่สุด) </label>
    </div>
    <hr>
    <div class="question-block">
        <p><b>4. ท่านคิดว่าการรับสารด้วยวิธีการ <u>ฟัง</u> ส่งผลต่อ "ความเข้าใจเนื้อหา" มากน้อยเพียงใด </b></p>
        <label><input type="radio" name="q4" value="1"> 1 (น้อยที่สุด) </label><br>
        <label><input type="radio" name="q4" value="2"> 2 (น้อย) </label><br>
        <label><input type="radio" name="q4" value="3"> 3 (ปานกลาง) </label><br>
        <label><input type="radio" name="q4" value="4"> 4 (มาก) </label><br>
        <label><input type="radio" name="q4" value="5"> 5 (มากที่สุด) </label>
    </div>
    <hr>
    <div class="question-block">
        <p><b>5. ท่านคิดว่าวิธีการรับสารรูปแบบใด ช่วยให้ท่าน "มีสมาธิ" จดจ่อกับเนื้อหาได้ดีกว่า </b></p>
        <label><input type="radio" name="q5" value="Read"> การอ่าน (Reading) </label><br>
        <label><input type="radio" name="q5" value="Listen"> การฟัง (Listening) </label><br>
        <label><input type="radio" name="q5" value="Equal"> ใกล้เคียงกัน (Equal) </label>
    </div>
    <hr>
    <div class="question-block">
        <p><b>6. โดยภาพรวม ท่าน "พึงพอใจ" ต่อวิธีการรับสารรูปแบบใดมากกว่า </b></p>
        <label><input type="radio" name="q6" value="Read"> การอ่าน (Reading) </label><br>
        <label><input type="radio" name="q6" value="Listen"> การฟัง (Listening) </label>
    </div>
    <hr>

    <div class="question-block">
        <p><b>7. ท่านใช้อุปกรณ์ชนิดใดในการทำแบบทดสอบนี้ </b></p>
        <label><input type="radio" name="q7" value="Computer"> คอมพิวเตอร์ตั้งโต๊ะ / โน้ตบุ๊ก (Desktop/Laptop) </label><br>
        <label><input type="radio" name="q7" value="Tablet"> แท็บเล็ต (Tablet / iPad) </label><br>
        <label><input type="radio" name="q7" value="Mobile"> โทรศัพท์มือถือ (Smartphone) </label><br>
        <label><input type="radio" name="q7" value="Other"> อื่นๆ </label>
    </div>
    <hr>

    <div class="question-block">
        <p><b>8. ท่านคิดว่าวิธีการรับสารรูปแบบใด ช่วยให้ท่าน "จดจำ" รายละเอียดของเนื้อหาได้ดีกว่า </b></p>
        <label><input type="radio" name="q8" value="Read"> การอ่าน (Reading) </label><br>
        <label><input type="radio" name="q8" value="Listen"> การฟัง (Listening) </label><br>
        <label><input type="radio" name="q8" value="Equal"> ใกล้เคียงกัน (Equal) </label>
    </div>
    <hr>

    <div class="question-block">
        <p><b>9. ในชีวิตประจำวัน ท่านมีพฤติกรรมการเสพสื่อ (ข่าวสาร/ความบันเทิง) ผ่านช่องทางใดเป็นหลัก </b></p>
        <label><input type="radio" name="q9" value="Read"> เน้นการอ่าน (หนังสือ/บทความออนไลน์/โซเชียลมีเดีย) </label><br>
        <label><input type="radio" name="q9" value="Listen"> เน้นการฟัง (Podcast/Youtube/Audiobook) </label><br>
        <label><input type="radio" name="q9" value="Equal"> ทั้งสองรูปแบบใกล้เคียงกัน </label>
    </div>
    <hr>

    <div class="question-block">
        <p><b>10. ข้อเสนอแนะเพิ่มเติม (ถ้ามี)</b></p>
        <textarea id="feedback" style="width:100%; height:80px;" placeholder="พิมพ์ข้อเสนอแนะของท่านที่นี่..."></textarea>
    </div>

</form>

<p id="err" class="error"></p>
<button id="submitBtn">บันทึกข้อมูลและจบการทดลอง</button>

<script>
document.getElementById("submitBtn").onclick = () => {
    let requiredOK = true;
    
    // ตรวจสอบ Q1-Q9 (เพิ่ม q8 เข้าไปในรายการ)
    const questionsToCheck = ["q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8", "q9"];
    
    questionsToCheck.forEach(name => {
        const v = document.querySelector(`input[name="${name}"]:checked`);
        if (!v) requiredOK = false;
    });

    if (!requiredOK) {
        document.getElementById("err").textContent = "กรุณาตอบคำถามให้ครบถ้วนทุกข้อ";
        return;
    }

    // --- รวบรวมข้อมูล ---
    const set = window.Experiment.getParam("set");
    let finalData = window.Experiment.loadExperimentData();
    
    // ดึงค่าจาก Survey
    questionsToCheck.forEach(name => {
        finalData[name] = document.querySelector(`input[name="${name}"]:checked`).value;
    });
    finalData.feedback = document.getElementById("feedback").value;
    
    // Set และ Null Check
    finalData.set = set; 
    
    finalData.read_time_P2 = finalData.read_time_P2 || null; 
    finalData.read_score_P2 = finalData.read_score_P2 || null;
    finalData.listen_time_P2 = finalData.listen_time_P2 || null;
    finalData.listen_score_P2 = finalData.listen_score_P2 || null;
    
    finalData.read_time = finalData.read_time || null;
    finalData.read_score = finalData.read_score || null;
    finalData.listen_time = finalData.listen_time || null;
    finalData.listen_score = finalData.listen_score || null;

    // ส่งข้อมูล
    window.Experiment.sendToSheet(finalData);
    
    // ล้างข้อมูล
    window.Experiment.clearExperimentData();

    document.body.innerHTML = `
        <div style="text-align:center; margin-top:50px;">
            <h1 style="color:green;">บันทึกข้อมูลเรียบร้อย</h1>
            <p>ขอขอบคุณสำหรับความร่วมมือในการทำวิจัยครั้งนี้</p>
            <p>ท่านสามารถปิดหน้าต่างนี้ได้</p>
        </div>
    `;
};
</script>

</body>
</html>